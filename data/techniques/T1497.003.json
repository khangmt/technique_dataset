{
    "id": "T1497.003",
    "tech_id": "T1497.003",
    "tech_name": "Time Based Evasion",
    "best_phrases": [],
    "tactics": [
        "TA0005",
        "TA0007"
    ],
    "features": [
        "FUNCTION",
        "DATA",
        "COMPONENT",
        "NETWORK",
        "REGISTRY"
    ],
    "locations": [
        "Linux",
        "macOS",
        "Windows"
    ],
    "procedures": [
        "relationship--00701b4a-9eab-41cc-9c09-f904a9799201",
        "relationship--0550f254-d194-4f84-b005-b7a2cdc94a4e",
        "relationship--0648b4df-ad84-4c94-8a0c-16e392f80f82",
        "relationship--141036b9-327f-4b13-a561-856697dd138b",
        "relationship--1492575f-9e3d-4ba0-ae2d-66711120adf6",
        "relationship--1fb2a0f2-5d60-4b72-9d18-5d5d06d0c2fe",
        "relationship--2426fc7d-5d97-4563-9889-d079ed36b4cf",
        "relationship--26802b94-95bf-4d01-a552-81069e62131a",
        "relationship--281eabd3-1965-4b62-8862-1edb15d49701",
        "relationship--2abdb5f5-6ff1-4f05-b925-429595011475",
        "relationship--3056fa10-d4a3-4830-96b7-987b10b5ae70",
        "relationship--323863fd-c133-45f4-9628-b09b039b7c31",
        "relationship--45eef730-8c5b-45fb-9cd9-c7998a764898",
        "relationship--53f5aaf3-b4de-4e31-bf50-a297bb8b61ca",
        "relationship--56f3245a-b7dc-46a5-8454-7476e03fe772",
        "relationship--57e7d8ef-33dd-4a08-bce2-e516a9662383",
        "relationship--5970c81f-932b-47e9-a63b-b4e30c351e7f",
        "relationship--6c56fdb0-d6cc-4a25-aa19-7191410704ef",
        "relationship--76f712e1-cc4c-43a2-b6a7-c288ac206aac",
        "relationship--7f152b13-3aae-4c67-b8f3-391cac671aed",
        "relationship--88a798b0-0820-4a6e-a9b2-416c84f3b357",
        "relationship--8aeea825-de75-404b-bde3-806ba749f416",
        "relationship--8f5e9158-1abe-4ed7-8a0a-df07f629aac8",
        "relationship--9e07c247-c778-496d-9972-6581f2d10c93",
        "relationship--a03c46d1-763a-40e8-952b-36b27be11dda",
        "relationship--a8e662f8-e644-44d8-8aca-79e8d7924826",
        "relationship--ab4d7a1b-2b5a-44b6-a363-363d3f3f6e05",
        "relationship--ac04e244-5ab3-4ac7-8f5d-575ec8ff67f0",
        "relationship--adbee939-28b3-4932-9e8d-992b7fdca835",
        "relationship--b29637f2-49be-4785-b82b-09661f25c42c",
        "relationship--b7f2b493-8c91-4793-8206-52d302906b2b",
        "relationship--bd289f02-1354-423e-b5e4-7aca35ec9d8a",
        "relationship--be51a4cd-8e2b-4605-9f8d-35e4689704f4",
        "relationship--c1db186f-0c57-4c10-b858-3ecc792bb224",
        "relationship--cbc18998-67f4-493a-b0d3-4aa50da3c407",
        "relationship--d231c64f-4a5f-43b8-a6e8-6ddd74d14eb3",
        "relationship--db2307cc-3e11-4b2f-83c8-be57371b9c51",
        "relationship--dec02920-c2d1-4340-a503-f6a38ae0b0f7",
        "relationship--e1ee2aae-72b0-4258-abab-2705d6b9268a",
        "relationship--e46888e6-8c13-4a9c-8638-f8c151bec3c6",
        "relationship--e5cb79c2-2bc0-47e2-be01-6bcf55d4c1a2"
    ],
    "graph_nodes": [
        {
            "count": 60,
            "id": 0,
            "texts": [
                "Raindrop",
                "initial installation",
                "detection",
                "Windows API kernel32!GetTickCountKernel32 call",
                "debugging",
                "long sleep",
                "detection",
                "sleep command",
                "sandbox detection",
                "sleep",
                "sandbox monitoring tools",
                "loader",
                "presence",
                "calls",
                "emulator",
                "GetTickCount API",
                "addon package",
                "final payload",
                "command timeout 20",
                "tools",
                "destructive actions",
                "time-based anti-debug check",
                "anti-debug function",
                "timing",
                "built-in function",
                "detection",
                "analysis",
                "printf and file I/O loops",
                "API hammering",
                "persistence establishment process",
                "QakBot dropper",
                "payload",
                "detection",
                "code",
                "task",
                "timer",
                "time measurements",
                "sleep operations",
                "3 different APIs",
                "malware",
                "installer",
                "installation",
                "antivirus solutions",
                "GetTickCount and GetSystemTimeAsFileTime API calls",
                "function timing",
                "detection",
                "anti-debugging",
                "API calls",
                "CPUID",
                "time checks",
                "detection",
                "Brute Ratel C4",
                "command",
                "XCSSET",
                "modules",
                "time call",
                "sleep command",
                "second time call",
                "time calls",
                "second stage payload"
            ],
            "label": "FUNCTION"
        },
        {
            "count": 7,
            "id": 1,
            "texts": [
                "computation",
                "itself",
                "itself",
                "third stage",
                "WScript.Sleep",
                "part",
                "sleep stage"
            ],
            "label": "OTHER"
        },
        {
            "count": 37,
            "id": 2,
            "texts": [
                "P8RAT",
                "SUNBURST",
                "BendyBear",
                "Egregor",
                "Clop",
                "SodaMaster",
                "Clambling",
                "Ursnif",
                "Okrum",
                "FatDuke",
                "DarkTortilla",
                "Bumblebee",
                "Crimson",
                "Saint Bot",
                "Lazarus Group",
                "Tomiris",
                "HermeticWiper",
                "Lokibot",
                "Snip3",
                "malware",
                "StrifeWater",
                "Pony",
                "TrickBot",
                "metaMain",
                "LiteDuke",
                "GrimAgent",
                "Bazar",
                "EvilBunny",
                "BADFLICK",
                "GoldenSpy",
                "WhisperGate",
                "DRATzarus",
                "GoldMax",
                "GuLoader",
                "SVCReady",
                "ThiefQuest",
                "AppleJeus"
            ],
            "label": "ACTOR"
        },
        {
            "count": 42,
            "id": 3,
            "texts": [
                "time",
                "period",
                "up to two weeks",
                "analysis environments",
                "signs",
                "time",
                "30 minutes",
                "contact",
                "30 minute delay",
                "random intervals",
                "hardcoded and randomized sleep interval",
                "15 days",
                "GetTickCount and GetSystemTimeAsFileTime data",
                "nine minutes",
                "command parameter",
                "sleep time responses",
                "default",
                "20-22 seconds",
                "five to six minutes",
                "30 seconds",
                "195 - 205 seconds",
                "5 minutes",
                "hours",
                "20 seconds",
                "conditions",
                "time",
                "execution trigger date",
                "ASCII Unix/Epoch time value",
                "API calls",
                "CPUID",
                "time checks",
                "30 minutes",
                "local time",
                "initial creation timestamp",
                "elapsed time",
                "file",
                ".report",
                "time",
                "amount",
                "time difference",
                "time",
                "time"
            ],
            "label": "DATA"
        },
        {
            "count": 13,
            "id": 4,
            "texts": [
                "analysis environments",
                "signs",
                "host",
                "sandbox or VMware services",
                "sandbox-based analysis systems",
                "sandbox",
                "targeted host",
                "virtual environment",
                "sandbox",
                "victim system",
                "machine",
                "sandbox",
                "system"
            ],
            "label": "COMPONENT"
        },
        {
            "count": 3,
            "id": 5,
            "texts": [
                "C2",
                "communication",
                "IP address"
            ],
            "label": "NETWORK"
        },
        {
            "count": 1,
            "id": 6,
            "texts": [
                "kernel32.dll Sleep function"
            ],
            "label": "REGISTRY"
        }
    ],
    "graph_edges": [
        {
            "id": "0_1",
            "source": 0,
            "dest": 1,
            "count": 1
        },
        {
            "id": "2_3",
            "source": 2,
            "dest": 3,
            "count": 26
        },
        {
            "id": "2_0",
            "source": 2,
            "dest": 0,
            "count": 36
        },
        {
            "id": "2_4",
            "source": 2,
            "dest": 4,
            "count": 6
        },
        {
            "id": "4_0",
            "source": 4,
            "dest": 0,
            "count": 1
        },
        {
            "id": "3_0",
            "source": 3,
            "dest": 0,
            "count": 3
        },
        {
            "id": "2_1",
            "source": 2,
            "dest": 1,
            "count": 5
        },
        {
            "id": "1_0",
            "source": 1,
            "dest": 0,
            "count": 2
        },
        {
            "id": "1_3",
            "source": 1,
            "dest": 3,
            "count": 3
        },
        {
            "id": "3_5",
            "source": 3,
            "dest": 5,
            "count": 1
        },
        {
            "id": "0_2",
            "source": 0,
            "dest": 2,
            "count": 3
        },
        {
            "id": "2_6",
            "source": 2,
            "dest": 6,
            "count": 1
        },
        {
            "id": "0_3",
            "source": 0,
            "dest": 3,
            "count": 6
        },
        {
            "id": "0_4",
            "source": 0,
            "dest": 4,
            "count": 3
        },
        {
            "id": "2_5",
            "source": 2,
            "dest": 5,
            "count": 1
        },
        {
            "id": "5_3",
            "source": 5,
            "dest": 3,
            "count": 1
        },
        {
            "id": "3_4",
            "source": 3,
            "dest": 4,
            "count": 2
        }
    ],
    "verbs": {
        "after": 2,
        "run": 1,
        "for": 14,
        "evade": 7,
        "of": 13,
        "use": 12,
        "perform": 4,
        "avoid": 2,
        "put": 1,
        "to": 4,
        "wait": 3,
        "initiate": 1,
        "with": 2,
        "detect": 2,
        "turn": 1,
        "at": 2,
        "implement": 1,
        "process": 1,
        "set": 2,
        "download": 3,
        "on": 2,
        "collect": 1,
        "basedon": 1,
        "receive": 1,
        "carry": 1,
        "execute": 4,
        "in": 2,
        "compare": 2,
        "modify": 1,
        "from": 4,
        "during": 1,
        "drop": 1,
        "delete": 1,
        "by": 2,
        "delay": 2,
        "reach": 1,
        "bypass": 1,
        "measure": 1,
        "into": 1,
        "under": 1,
        "as": 1,
        "base": 1,
        "enter": 1,
        "any": 1,
        "invoke": 2,
        "check": 1,
        "identify": 1,
        "between": 1
    }
}